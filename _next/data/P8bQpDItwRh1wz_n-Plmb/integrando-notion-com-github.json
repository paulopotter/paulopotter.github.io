{"pageProps":{"post":{"title":"Integrando Notion com Github","category":[],"date":"2023-05-22 15:15","cover_image":"https://umdevqualquer.com.br/images/integrando-notion-com-github/Frame_1_XghZLEg0.png","cover_image_alt":"Imagem com a logo da notion + logo github actions","cover_image_link":null,"cover_image_by":null,"series":[],"summary":"\nFala pessoa, como cÃª tÃ¡?\n\nSim, o blog nÃ£o morreu ğŸ˜‚, eu sÃ³ nÃ£o tenho conseguido escrever nada. Por mais que meus posts sejam como especial ...","slug":"integrando-notion-com-github","content":"Fala pessoa, como cÃª tÃ¡?\n\nSim, o blog nÃ£o morreu ğŸ˜‚, eu sÃ³ nÃ£o tenho conseguido escrever nada. Por mais que meus posts sejam como especial de natal, que sÃ³ aparece uma vez por ano e nÃ£o necessariamente Ã© tÃ£o bom ğŸ¤£ğŸ¤£.\n\nEu tenho estado muito ocupado e acabo nÃ£o conseguido parar pra escrever, principalmente pela forma que eu preciso pra escrever. Meu blog Ã© feito com NextJS e hospedado via Github pages e por isso, eu preciso ou estar no meu pc + escrever + realizar o build e postar ou baixar o projeto + instalar dependÃªncias + escrever + realizar o build e entÃ£o postar. O que aumenta o â€œcustoâ€ na hora de escrever (*Resumindo, da preguiÃ§a!*).\n\n<!-- START_SUMMARY -â†’\n\nMas como o titulo do post da o spoiler, eu descobri uma forma de facilitar a minha criaÃ§Ã£o de post utilizando o poder do Notion, sem tirar a liberdade que eu possuo em ter o meu blog feito por mim e hospedado no Github pages.\n\n<!-- END_SUMMARY -â†’\n\nEu tenho trabalhado muito voltado ao DX ( e esse assunto jÃ¡ estÃ¡ na lista de posts pra escrever ) mas eu mesmo nÃ£o faÃ§o isso pra mim ( o clÃ¡ssico â€œ_em casa de ferreiro, o espeto Ã© de pau_â€ ).\n\n## Conhecendo as ferramentas\n\n- [**Notion**](https://notion.so)\n\n\tOnde eu pretendo escrever e gerenciar os posts do meu blog.\n\n\t_Se vocÃª nÃ£o conhece o_ [_Notion_](https://notion.so) _eu recomendo, Ã© uma grande ferramenta que ajuda em vÃ¡rios pontos da minha vida._\n\n- [**Github**](https://github.com) (Pages e Actions)\n\n\tHoje eu jÃ¡ hospedo o meu blog via Github Pages, visto que o blog Ã© estÃ¡tico e finalmente vou utilizar o Github Actions para fazer o build e o deploy do blog.\n\n- [**Next JS**](https://nextjs.org/)\n\n\tPara gerar os estÃ¡ticos eu fiz o meu blog inteiro utilizando o Next.\n\n## ComeÃ§ando pelo o comeÃ§o\n\nEu, a um tempo, estava incomodado de nÃ£o ter criado uma pipeline pra fazer os testes e o build/deploy do meu blog, mas mais incomodado ainda em nÃ£o estar postando com frequÃªncia, principalmente porque hoje para mim Ã© cansativo escrever um post.\n\nHoje estou mais acostumado com o Gitlab CI, visto que na Globo usamos o Gitlab. Eu jÃ¡ conhecia o Github Actions, mas nunca havia mexido. EntÃ£o acabava postergando o aprendizado e a utilizaÃ§Ã£o do Github actions. \n\nEm um dado momento, dado a praticidade de utilizar o Notion, eu acabei me perguntado se nÃ£o era possÃ­vel integrar ele com o meu Blog, para facilitar o gerenciamento dos posts e assim me incentivar a escrever mais ( ainda mais porque eu to cheio de ideias de post mas sem saco de passar pelo o processo de escrita que possuo hoje ).\n\nCom isso, acabei encontrando uma action para o Github, que faz o a integraÃ§Ã£o com o Notion, porÃ©m eu tive uma certa dificuldade para configurÃ¡-lo ğŸ˜, a documentaÃ§Ã£o dele foi a melhor que eu achei dessas actions, porÃ©m jÃ¡ estÃ¡ meio desatualizada e nÃ£o tem algumas infos importantes, que eu quebrei a cabeÃ§a para entender.\n\nChega de histÃ³ria, vamos para a aÃ§Ã£o!\n\n## Notion\n\nPara facilitar a visualizaÃ§Ã£o, vamos comeÃ§ar adaptando o Notion para esperar a integraÃ§Ã£o com o Github, para isso vamos criar uma pagina de database e nela vai ficar listada todos os posts que serÃ£o publicados no blog. EntÃ£o coloque as propriedade que vocÃª quiser, no meu caso ficou assim: \n\n![Print da tela do database do notion com as colunas: Title, created_at, Status, Category](https://s3.us-west-2.amazonaws.com/secure.notion-static.com/d439790a-fcdc-4311-b2d1-286646825697/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIAT73L2G45EIPT3X45%2F20230522%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230522T151508Z&X-Amz-Expires=3600&X-Amz-Signature=6d92816c008b0ecbe9342502b75f739197677aa07ad6c267ed014d9fe8649f1b&X-Amz-SignedHeaders=host&x-id=GetObject)\n\n_Os campos podem ser quais vocÃª quiser, porem Ã©_ _**obrigatÃ³rio**_ _possuir o campo â€œstatusâ€ (ou outro que faÃ§a o mesmo trabalho, que vocÃª entenderÃ¡ mais a frente)._ \n\nCom essa tabela criada, jÃ¡ possuÃ­mos uma estrutura onde podemos criar todos os nossos post e, de brinde, criar status onde vocÃª pode saber se jÃ¡ estÃ¡ postado, escrevendo ou Ã© apenas uma ideia.\n\n### Iniciando a integraÃ§Ã£o\n\n- Agora para preparar o terreno para integraÃ§Ã£o vamos adicionar uma conexÃ£o, nas opÃ§Ãµes da tabela, vÃ¡ atÃ© gerenciamento de conexÃ£o (Manage connections)\n\n![](https://s3.us-west-2.amazonaws.com/secure.notion-static.com/9cae4ff0-b558-4151-9420-31e5b3ef8dba/Screenshot_2023-05-13_at_22.15.11.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIAT73L2G45EIPT3X45%2F20230522%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230522T151508Z&X-Amz-Expires=3600&X-Amz-Signature=e559c971c4024d028fc20304cc2d1542f0eca64d4926fd2c1d3e165dda407ab4&X-Amz-SignedHeaders=host&x-id=GetObject)\n\n- Na janela que abrir, procure no fim da tela o campo: _Developer or manager integrations_\n\n![](https://s3.us-west-2.amazonaws.com/secure.notion-static.com/b7490e14-1225-450c-bec9-994eb3381989/Screenshot_2023-05-13_at_22.15.33.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIAT73L2G45EIPT3X45%2F20230522%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230522T151508Z&X-Amz-Expires=3600&X-Amz-Signature=283df9f5a44fde977f56736354d3eced4587614656c67b107c39c55f3da41447&X-Amz-SignedHeaders=host&x-id=GetObject)\n\n- Ele vai te redirecionar atÃ© a area de integraÃ§Ãµes de api do Notion\n\n![](https://s3.us-west-2.amazonaws.com/secure.notion-static.com/f3b965f3-b88f-4e8d-98cc-42ca7418be0c/Screenshot_2023-05-13_at_22.15.56.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIAT73L2G45EIPT3X45%2F20230522%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230522T151508Z&X-Amz-Expires=3600&X-Amz-Signature=24a1fbf0e1bfe46463bf68c5748f629a2f3c1e1e1d6efa7ba8f74ec744e7af4a&X-Amz-SignedHeaders=host&x-id=GetObject)\n\n- Clique para adicionar uma nova integraÃ§Ã£o ( New Integration ) e preencha o campo de Name com o nome que voce quiser dar, uma imagem para vocÃª saber o que vocÃª estÃ¡ associando e qual o workspace do notion essa api vai ser associada.\n\n![](https://s3.us-west-2.amazonaws.com/secure.notion-static.com/755a0360-1355-49ab-a414-e5fb653b01b4/Screenshot_2023-05-13_at_22.17.13.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIAT73L2G45EIPT3X45%2F20230522%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230522T151508Z&X-Amz-Expires=3600&X-Amz-Signature=b81e75cbae104d6cf06485f2cbf8687129286a9d287b566b5c822af457b511ab&X-Amz-SignedHeaders=host&x-id=GetObject)\n\nApÃ³s criado ele irÃ¡ gerar uma **secret key,** guarde ela que iremos utiliza-la mais a frente. (VocÃª consegue acessar ela a hora que vocÃª quiser, nÃ£o se preocupe).\n\n- Depois disso, voltamos para a nossa tabela e acessamos a configuraÃ§Ã£o dela, e no campo de conexÃ£o, a gente adiciona a  integraÃ§Ã£o que acabamos de criar.\n\n![](https://s3.us-west-2.amazonaws.com/secure.notion-static.com/8fea011f-4cf6-4d5d-a718-75598d883452/Screenshot_2023-05-13_at_22.18.47.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIAT73L2G45EIPT3X45%2F20230522%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230522T151508Z&X-Amz-Expires=3600&X-Amz-Signature=e4559489f2b679803f877ee6d30d81df02eacc71e3b0e8e06c7e6e1b6d8d608b&X-Amz-SignedHeaders=host&x-id=GetObject)\n\nPronto! A parte referente ao Notion foi finalizada ğŸ˜„\n\n## Github actions (Gh Actions)\n\nEu nÃ£o vou mostrar uma config completa e/ou explicar como funciona o Github Actions, atÃ© porque eu ainda estou aprendendo/ me entendendo com ele. \n\n### Environments\n\nVamos criar logo as nossas variÃ¡veis de ambiente para ser utilizada na pipeline. \n\n-  VÃ¡ atÃ© as configuraÃ§Ãµes do seu projeto e acesse o menu â€œ**Environments**â€, \n\nNessa tela vocÃª terÃ¡ duas formas de criar variÃ¡veis de ambiente, uma secreta e outra aberta.\n\n-  Na parte de criaÃ§Ã£o das variÃ¡veis secretas, nÃ³s vamos criar duas: **NOTION_ROOT_PAGE_ID** e **NOTION_TOKEN**,  onde os valores deles serÃ£o a url da database do notion e a **secret key** obtido na explicaÃ§Ã£o do Notion, respectivamente.\n\n![](https://s3.us-west-2.amazonaws.com/secure.notion-static.com/567d71da-3a4a-4b18-bd08-8c43347dca45/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIAT73L2G45EIPT3X45%2F20230522%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230522T151508Z&X-Amz-Expires=3600&X-Amz-Signature=78f9054f3bde5aa8477c19d6f3d4b943085c1fc27e8cdfb257cf25a6eba608b7&X-Amz-SignedHeaders=host&x-id=GetObject)\n\n-  Na parte da criaÃ§Ã£o das variÃ¡veis, eu preferi criar 3 variÃ¡veis, para me dar a liberdade de nÃ£o ter que ficar mexendo no cÃ³digo toda hora que eu precisar alterar alguma info que a action usa para tratar os dados do notion. Essas variÃ¡veis sÃ£o: **FILTER_PROP**, **FILTER_VALUES** e  **POST_URI**. Onde:\n\n\t- **FILTER_PROP** fica o nome do campo onde eu quero que o Github filtre para saber qual o post ele terÃ¡ que publicar.\n\n\t- **FILTER_VALUES** fica o valor do campo que, quando um post tiver esse valor no campo de filtro, serÃ¡ o indicativo para o Github para saber que Ã© o post ele terÃ¡ que publicar.\n\n\t- **POST_URI** Ã© o nome do campo onde ele vai usar o valor final (como o nome do post, por exemplo) para ajudar a montar o path de arquivos.\n\n![](https://s3.us-west-2.amazonaws.com/secure.notion-static.com/a644c908-9438-4510-b947-d8981a2e5d03/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIAT73L2G45EIPT3X45%2F20230522%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230522T151508Z&X-Amz-Expires=3600&X-Amz-Signature=b57d039f50c92352eed465fe694dc2fd2bcd341e91910fadb6c4e96ac01b9470&X-Amz-SignedHeaders=host&x-id=GetObject)\n\n### Criando seu job / action:\n\nPesquisando, acabei caindo na action [Notion jam](https://github.com/victornpb/notion-jam), que pega os dados e gera um arquivo markdown. TambÃ©m peguei outras actions, o [git auto commit action](https://github.com/stefanzweifel/git-auto-commit-action) e o [GitHub push action](https://github.com/ad-m/github-push-action) para poder fazer um commit e puxar o arquivo criado na branch que eu to usando.\n\nPara facilitar a explicaÃ§Ã£o, eu vou colar o meu arquivo de actions aqui \n\n```yaml\nname: Sync Notion pages to posts\n\non:\n  schedule:\n    - cron: '0 13 * * *' # daily\n\n  workflow_dispatch:\n\njobs:\n  get_and_commit_notions_posts:\n    runs-on: ubuntu-latest\n    environment: github-pages\n    steps:\n      - uses: actions/checkout@v3\n\n      - name: notion-jam\n        uses: victornpb/notion-jam@v0.0.13\n        with:\n          NOTION_SECRET: ${{ secrets.NOTION_TOKEN}}\n          NOTION_DATABASE: ${{ secrets.NOTION_ROOT_PAGE_ID }}\n          FILTER_PROP: ${{ vars.FILTER_PROP }}\n          FILTER_VALUES: ${{ vars.FILTER_VALUES }}\n          ARTICLE_PATH: src/posts/${{ vars.POST_URI }}.md\n          ASSETS_PATH: public/images/${{ vars.POST_URI }}/\n          PARALLEL_PAGES: 25\n          PARALLEL_DOWNLOADS_PER_PAGE: 3\n          DOWNLOAD_IMAGE_TIMEOUT: 30\n\n      - name: Save changes\n        uses: stefanzweifel/git-auto-commit-action@v4\n        with:\n          commit_message: 'docs: add new post'\n      - uses: ad-m/github-push-action@master\n        with:\n          github_token: ${{ secrets.GITHUB_TOKEN }}\n          branch: ${{ github.ref }}\n```\n\n[Link para o action atualizado](https://github.com/paulopotter/paulopotter.github.io/blob/nextjs/.github/workflows/notion.yml)\n\n## Bonus track\n\nPara facilitar ainda mais a minha vida, eu consegui criar um template na hora de criar um post, dentro do notion, onde ele jÃ¡ preenche alguns campos para mim. AlÃ©m de criar botÃµes de criaÃ§Ã£o rÃ¡pida de post, onde ele jÃ¡ preenche alguns dados de acordo com o conteÃºdo do botÃ£o.\n\n![](https://s3.us-west-2.amazonaws.com/secure.notion-static.com/d16fe037-70ef-46ed-b684-c8fc02d3e6df/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIAT73L2G45EIPT3X45%2F20230522%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230522T151508Z&X-Amz-Expires=3600&X-Amz-Signature=a195f9b99122538fd31625c75ce8824cd853292d9739b12708f4a917b863795e&X-Amz-SignedHeaders=host&x-id=GetObject)\n\n## Thats all folks\n\nEu ainda estou descobrindo o que eu posso fazer no Notion e isso refletir no meu Blog, ainda nÃ£o sei se todas as funcionalidades que eu tenho no blog eu consigo criar via o Notion. Talvez, posts mais complexos ainda precisem ser manuais.\n\nAinda tenho como meta, conseguir ver uma forma de publicar nas redes sociais automaticamente, talvez atÃ© via Github actions tambÃ©m, mais infelizmente nÃ£o vai ser dessa vez.\n\nÃ‰ isso, espero que esse post te ajude em algo ğŸ˜ƒ.\n\nE com muito orgulho, esse Ã© o primeiro post que eu fiz a partir dessa integraÃ§Ã£o! Espero que a partir de agora eu consiga manter o blog mais atualizado, graÃ§as a essa facilidade.\n\nValeu, Falow, atÃ© a prÃ³xima!\n","readingTime":"1 min","related":{"prevPost":{"title":"Utilizando ARIA no seu projeto - Tooltip","date":"2022-07-17","slug":"utilizando-aria-no-seu-projeto-tooltip"}}}},"__N_SSG":true}