<!DOCTYPE html><html lang="pt-BR" data-info="2025-05-15 15:28:53" prefix="og: https://ogp.me/ns#"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><link rel="preload" href="/_next/static/css/3d4c49d454f5110f.css" as="style"/><link rel="stylesheet" href="/_next/static/css/3d4c49d454f5110f.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-d5c25fd331c4dadd.js" defer=""></script><script src="/_next/static/chunks/framework-4556c45dd113b893.js" defer=""></script><script src="/_next/static/chunks/main-d1c8bf56a477bf12.js" defer=""></script><script src="/_next/static/chunks/pages/_app-b8e294211c93df66.js" defer=""></script><script src="/_next/static/chunks/793-f7eccf4efa0853f4.js" defer=""></script><script src="/_next/static/chunks/802-98c889aa55a2df50.js" defer=""></script><script src="/_next/static/chunks/pages/%5Bslug%5D-c11c230256b8eaf6.js" defer=""></script><script src="/_next/static/pho6e2GPbC8W_Oa7eB7-p/_buildManifest.js" defer=""></script><script src="/_next/static/pho6e2GPbC8W_Oa7eB7-p/_ssgManifest.js" defer=""></script></head><body><div id="__next"></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"Criando sua primeira APP para Smart TVs (Parte 2)","category":["Smart TV","Js","React"],"date":"2020-04-09","cover_image":"https://umdevqualquer.com.br/images/smart-tv-plex.jpg","cover_image_alt":"Smart Tv from google","cover_image_link":"https://www.popsci.com/resizer/lU2v75pLrtqZZV7TOZsVmhM7YbI=/1782x1336/filters:focal(600x450:601x451)/arc-anglerfish-arc2-prod-bonnier.s3.amazonaws.com/public/7SFVUBKE3F5G4N74QM7QJSGU4E.jpg","cover_image_by":"Imagem retirada do Google","series":[{"title":"Criando sua primeira APP para Smart TVs (Parte 2)","series":"Criando sua primeira APP para Smart TVs"},{"title":"Criando sua primeira APP para Smart TVs","series":"Criando sua primeira APP para Smart TVs","slug":"criando-sua-primeira-app-para-smart-tvs"}],"summary":"Iai meu Polvo üêô como c√™s t√£o?\n\nDando continuidade a nossa s√©rie da cria√ß√£o de uma app para Smart Tvs, hoje n√≥s iremos finalizar os testes e corrigir os bugs deixa","slug":"criando-sua-primeira-app-para-smart-tvs-parte-2","content":"Iai meu Polvo üêô como c√™s t√£o?\n\nDando continuidade a nossa s√©rie da cria√ß√£o de uma app para Smart Tvs, hoje n√≥s iremos finalizar os testes e corrigir os bugs deixados no ultimo post.\n\n## Bug hunter:\n\n\u003cfigure\u003e\n    \u003cimg src=\"./images/criando-sua-primeira-app-para-smart-tvs-parte-2/131-bug-free.png\" alt=\"Mokeyuser - Bug free\" /\u003e\n    \u003ccenter\u003e\u003cfigcaption\u003eFonte: \u003ca href=\"https://www.monkeyuser.com/\"\u003eMonkeyUser\u003c/a\u003e\u003c/figcaption\u003e\u003c/center\u003e\u003cbr/\u003e\n\u003c/figure\u003e\n\nEnquanto eu navegava pela app, notei uma falha na parte da navega√ß√£o, n√≥s estamos **exibindo apenas** items relacionados a \"TV\" mas n√£o estamos filtrando-os. Ent√£o ao chegar no final da lista, a navega√ß√£o \"continua\" mesmo sem ter item para navegar. E para corrigir vamos modificar o c√≥digo com:\n\n```jsx\ncomponentDidMount() {\n    // [...]\n    response.anime.forEach(element =\u003e {\n        if (element.type === 'TV') {\n        animes.push(element)\n        }\n    })\n    // [...]\n}\n\nonKeyDown(e) {\n    // [...]\n    case 39: // right\n        if (activeItem \u003c animes.length\n          \u0026\u0026 activeItem + 1 \u003c animes.length) {\n          newActiveItem += 1\n        }\n    break\n    case 40: // down\n        if (activeItem \u003c animes.length) {\n          if (activeItem + 4 \u003e animes.length) {\n            newActiveItem = animes.length - 1\n          } else {\n            newActiveItem += 4\n          }\n        }\n    break\n\n    // [...]\n}\n\nrender() {\n    const { animes } = this.state\n    return animes.map((anime, i) =\u003e this.tmpl(anime, i))\n}\n```\n\n## Hora dos testes:\n\n\u003cfigure\u003e\n    \u003cimg src=\"./images/criando-sua-primeira-app-para-smart-tvs-parte-2/86-fixing-unit-tests.png\" alt=\"Mokeyuser - unit test\" /\u003e\n    \u003ccenter\u003e\u003cfigcaption\u003eFonte: \u003ca href=\"https://www.monkeyuser.com/\"\u003eMonkeyUser\u003c/a\u003e\u003c/figcaption\u003e\u003c/center\u003e\u003cbr/\u003e\n\u003c/figure\u003e\n\nComo eu apenas adicionei a suite de test, e n√£o realizei nenhum teste, est√° na hora de aumentar o nosso coverage! üòÑ\nPara simplificar o post, eu vou deixar o [link do arquivo completo do teste](https://github.com/paulopotter/my-first-smart-tv-app/blob/post-2/src/App.test.js) para voc√™s verem. Mas vou destacar o seguintes pontos:\n\n**Coverage**\n\nAgora j√° estamos com **95%** do componente testado ü§©\n\n**babel**\n\nFoi necess√°rio adicionar `@babel/plugin-transform-runtime` e com isso alterar o `.babelrc` para:\n\n```json\n{\n    \"presets\": [\n      [\n        \"@babel/preset-env\",\n        {\n          \"targets\": {\n            \"esmodules\": true\n          }\n        }\n      ],\n      \"@babel/preset-react\"\n    ]\n}\n```\n\n**package**\n\nPrecisamos instalar o *nock* (`yarn add -D nock`), e atualizar o nosso `package.json` ([de uma olhada no arquivo](https://github.com/paulopotter/my-first-smart-tv-app/blob/post-2/package.json), pois houveram modifica√ß√µes nas vers√µes dos pacotes).\n\n**Arquivo de mock**\n\nPara poder testar sem ter que ficar batendo na api toda hora, eu criei uma pasta `__mock__` e adicionei um [arquivo de mock](https://github.com/paulopotter/my-first-smart-tv-app/blob/post-2/src/__mock__/Animes.js) l√°.\n\n**jest config**\n\nPor causa do mock que precisamos fazer, temos que remover a pasta do `mock` do coverage:\n\n```js\n// linha: 30\n coveragePathIgnorePatterns: [\n    \"/node_modules/\",\n    \"/__mock__/\",\n  ],\n```\n\n## Melhorando a experi√™ncia:\n\nAgora que n√≥s possu√≠mos uma tela funcionando, precisamos melhorar minimamente a experi√™ncia da mesma. E para isso, temos que corrigir a navega√ß√£o vertical, visto que ao navegar para baixo, o scroll n√£o segue o foco.\n\nVamos atualizar o css, adicionando altura para as imagens e depois dando um tapa no visual.\n\n```css\nbody {\n    background-color: #0f0f0f;\n    color: #f1f1f1;\n    height: 720px;\n    overflow: hidden;\n}\n.wrapper {\n    padding-top: 20px;\n}\n\n.poster-wrapper {\n    display: inline-block;\n    height: 390px;\n    text-align: center;\n    vertical-align: bottom;\n    width: 310px;\n}\n\n.poster-wrapper figure {\n     position: relative;\n}\n\n.poster-wrapper img {\n    height: 321px;\n    width: 225px;\n}\n\n.poster-wrapper--active img{\n    height: 381px;\n    width: 285px;\n}\n\n.poster-wrapper span {\n    background-color: rgba(0,0,0,0.7);\n    bottom: 0;\n    display: none;\n    font-size: 20px;\n    left: 0;\n    min-height: 15%;\n    padding: 15px 10px;\n    position: absolute;\n    right: 0;\n}\n\n.poster-wrapper--active span {\n    display: inline;\n}\n\n```\n\nAgora vamos adicionar o efeito de scroll e para isso, precisamos de uma `div` envolvendo todo o conte√∫do al√©m de adicionar margin √† ela automaticamente utilizando o `state`.\n\n```jsx\nconstructor(props) {\n    super(props)\n    this.state = {\n      // [...]\n      wrapperStyle: { marginTop: 0 }\n    }\n}\n\n// [...]\n\nrender() {\n  const {\n    animes,\n    wrapperStyle,\n  } = this.state\n  return (\n    \u003cdiv className=\"wrapper\" style={wrapperStyle}\u003e\n      {\n        animes.map((anime, i) =\u003e this.tmpl(anime, i))\n      }\n    \u003c/div\u003e\n  )\n}\n```\n\nAgora, para criarmos a anima√ß√£o, vamos adicionar o valor da altura dos itens (`390px`) ao `margin-top` da div `wrapper`. Ent√£o toda vez que apertarmos o bot√£o para baixo vamos subtrair esse valor e para cima vamos adicionar esse valor.\n\n```jsx\nanimate(keyCode) {\n    if (keyCode === 40) {\n      this.setState(prevState =\u003e ({\n        wrapperStyle: {\n          marginTop: `${parseInt(prevState.wrapperStyle.marginTop, 10) - 390}px`,\n        }\n      }))\n    }\n\n    if (keyCode === 38) {\n      this.setState(prevState =\u003e ({\n        wrapperStyle: {\n          marginTop: `${parseInt(prevState.wrapperStyle.marginTop, 10) + 390}px`,\n        }\n      }))\n    }\n  }\n\n```\n\ne no `onkeyDown` eu chamo o animate:\n\n```js\n// linha 57\nthis.animate(40)\n// linha 67\nthis.animate(38)\n```\n\n## √â isso a√≠!\n\n![Nossa App funcionando](./images/criando-sua-primeira-app-para-smart-tvs-parte-2/minha-primeira-smart-tv-app-pt2.gif)\n\nAinda temos muita coisa para fazer por√©m, j√° temos o suficiente para testar na TV. No nosso pr√≥ximo post, desta s√©rie, eu ire mostrar como testar essa app numa Smart TV da LG.\n\nLembrando que eu estou fazendo o mais b√°sico de uma aplica√ß√£o, para poder demonstrar como √© funcionamento de uma app (web hosted) de smart tv. Coisas como organiza√ß√£o do projeto, layout e player n√£o est√£o sendo desenvolvidos, talvez em post futuros eu melhore a nossa app, mas voc√™ √© livre para modificar a app da melhor forma que voc√™ achar üòâ.\n\n## Links uteis:\n\nAntes de finalizar eu gostaria de recomendar que voc√™s deem uma olhada nos links do blog do meu amigo [Kevin Maduro (kcsmad)](https://kcsmad.wordpress.com/) que, alem de mostrar outro(s) (bons) ponto(s) de vista, complementam bem os posts sobre smart tv que eu estou fazendo.\n\n*   [Desmitificando o mundo das Smart Tvs](https://kcsmad.wordpress.com/2020/02/29/desmistificando-o-mundo-das-smart-tvs/)\n*   [Princ√≠pios b√°sicos para aplica√ß√µes de Smart Tv](https://kcsmad.wordpress.com/2020/03/01/principios-basicos-para-aplicacoes-de-smart-tvs/)\n\n√â isso, n√£o se esque√ßam de comentar e compartilhar e **at√© o nosso pr√≥ximo post!**\n","readingTime":"4 min","related":{"nextPost":{"title":"Meus plugins favoritos para vscode","date":"2020-05-02","slug":"meus-plugins-favoritos-para-vscode"},"prevPost":{"title":"Criando sua primeira APP para Smart TVs","date":"2020-01-19","slug":"criando-sua-primeira-app-para-smart-tvs"}}}},"__N_SSG":true},"page":"/[slug]","query":{"slug":"criando-sua-primeira-app-para-smart-tvs-parte-2"},"buildId":"pho6e2GPbC8W_Oa7eB7-p","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body><link href="https://fonts.googleapis.com/css2?family=Bitter:ital,wght@0,400;1,700&amp;family=Montserrat:wght@400;700&amp;display=swap" rel="stylesheet"/></html></body></html>